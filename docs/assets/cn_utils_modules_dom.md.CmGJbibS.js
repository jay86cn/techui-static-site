import{_ as i,c as a,o as t,aj as e}from"./chunks/framework.DPdjieCD.js";const c=JSON.parse('{"title":"DOM 操作","description":"","frontmatter":{},"headers":[],"relativePath":"cn/utils/modules/dom.md","filePath":"cn/utils/modules/dom.md"}'),n={name:"cn/utils/modules/dom.md"};function l(h,s,p,k,o,r){return t(),a("div",null,[...s[0]||(s[0]=[e(`<h1 id="dom-操作" tabindex="-1">DOM 操作 <a class="header-anchor" href="#dom-操作" aria-label="Permalink to &quot;DOM 操作&quot;">​</a></h1><p><strong>DOM 模块</strong> 提供了对原生 DOM 操作的轻量级封装，特别针对 TechUI 的 <strong>TuiAdaptive (自适应)</strong> 系统进行了深度优化。</p><p>它不仅包含常规的元素查询与查找，还提供了在复杂缩放环境（Scale Context）下精准计算元素尺寸与坐标的核心算法。</p><h2 id="引入方式" tabindex="-1">引入方式 <a class="header-anchor" href="#引入方式" aria-label="Permalink to &quot;引入方式&quot;">​</a></h2><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { syncContSize, tCoreTpl, tDom, tQuery } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;@techui/utils&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span></code></pre></div><h2 id="元素查询" tabindex="-1">元素查询 <a class="header-anchor" href="#元素查询" aria-label="Permalink to &quot;元素查询&quot;">​</a></h2><p><strong>tQuery</strong> 对象提供了一组用于查找和遍历 DOM 节点的快捷方法。</p><h3 id="tquery-el-selector-all" tabindex="-1">tQuery.el(selector, all) <a class="header-anchor" href="#tquery-el-selector-all" aria-label="Permalink to &quot;tQuery.el(selector, all)&quot;">​</a></h3><p><code>querySelector</code> 的简写封装。</p><ul><li><strong>selector</strong>: CSS 选择器字符串。</li><li><strong>all</strong>: <code>boolean</code>。默认为 <code>false</code> 返回单个元素，设为 <code>true</code> 返回 NodeList。</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> app</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tQuery.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">el</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;#app&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> items</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tQuery.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">el</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.list-item&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="tquery-get1stparent-el-selector" tabindex="-1">tQuery.get1stParent(el, selector) <a class="header-anchor" href="#tquery-get1stparent-el-selector" aria-label="Permalink to &quot;tQuery.get1stParent(el, selector)&quot;">​</a></h3><p>查找最近的匹配父级元素（<code>closest</code> 的封装）。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 查找当前点击元素最近的 .card 父级</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> card</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tQuery.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">get1stParent</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(e.target, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;.card&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="tquery-clearexcept-container-exceptel" tabindex="-1">tQuery.clearExcept(container, exceptEl) <a class="header-anchor" href="#tquery-clearexcept-container-exceptel" aria-label="Permalink to &quot;tQuery.clearExcept(container, exceptEl)&quot;">​</a></h3><p>清空容器内的所有子元素，但保留指定的某一个元素。常用于保留 loading 遮罩或特定状态节点。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">tQuery.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">clearExcept</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(document.body, document.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">querySelector</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;#app&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">));</span></span></code></pre></div><h3 id="tquery-valuebypath-obj-path-fallback" tabindex="-1">tQuery.valueByPath(obj, path, fallback) <a class="header-anchor" href="#tquery-valuebypath-obj-path-fallback" aria-label="Permalink to &quot;tQuery.valueByPath(obj, path, fallback)&quot;">​</a></h3><p><strong>多语言/深层对象取值器</strong>。 虽然不是直接操作 DOM，但常用于在 DOM 渲染前安全获取 <code>data.user.profile.name</code> 形式的数据。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> data</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { user: { name: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;TechUI&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } };</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tQuery.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">valueByPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;user.name&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// &quot;TechUI&quot;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> age</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tQuery.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">valueByPath</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(data, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;user.age&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">18</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 18 (Fallback)</span></span></code></pre></div><h2 id="尺寸与自适应" tabindex="-1">尺寸与自适应 <a class="header-anchor" href="#尺寸与自适应" aria-label="Permalink to &quot;尺寸与自适应&quot;">​</a></h2><p><strong>tDom</strong> 是 TechUI 处理自适应布局的核心对象，它能识别元素是否处于 <code>#tuiAdpt</code>（自适应缩放面板）内部，并计算真实的物理坐标。</p><h3 id="tdom-isinadp-el" tabindex="-1">tDom.isInAdp(el) <a class="header-anchor" href="#tdom-isinadp-el" aria-label="Permalink to &quot;tDom.isInAdp(el)&quot;">​</a></h3><p>判断一个元素是否位于自适应缩放容器 (<code>#tuiAdpt</code>) 内部。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (tDom.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">isInAdp</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(myElement)) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;当前元素处于缩放环境中&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h3 id="tdom-rootinfo-el" tabindex="-1">tDom.rootInfo(el) <a class="header-anchor" href="#tdom-rootinfo-el" aria-label="Permalink to &quot;tDom.rootInfo(el)&quot;">​</a></h3><p>获取元素相对于<strong>浏览器视口 (Root)</strong> 以及<strong>自适应容器 (Adpt)</strong> 的详细布局信息。 此方法解决了在 <code>transform: scale()</code> 环境下，原生 <code>getBoundingClientRect</code> 数据换算困难的问题。</p><ul><li><strong>返回</strong>: 包含 <code>rootWidth</code>, <code>isInAdp</code>, 以及 <code>A2RTop</code> (Adaptive To Root Top) 等关键坐标偏移量。</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> layout</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> tDom.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">rootInfo</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(el);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// layout.A2RLeft 表示自适应容器左边界距离视口的距离</span></span></code></pre></div><h3 id="synccontsize-options" tabindex="-1">syncContSize(options) <a class="header-anchor" href="#synccontsize-options" aria-label="Permalink to &quot;syncContSize(options)&quot;">​</a></h3><p><strong>容器尺寸同步计算器</strong>。 用于计算“源元素”的几何属性，以便将这些属性应用到“目标元素”上（目前主要用于TuiAdaptive的同步容器的计算）。</p><ul><li><strong>参数</strong>: <ul><li><code>source</code>: 源 DOM 元素。</li><li><code>target</code>: 目标 DOM 元素（注：源码中实际样式赋值已被注释，主要用于返回计算后的 Rect 对象）。</li><li><code>syncPosition</code>: <code>boolean</code>，是否计算位置。</li><li><code>positionBaseTo</code>: <code>&#39;root&#39;</code> (基于视口) | <code>&#39;parent&#39;</code> (基于父容器偏移)。</li></ul></li><li><strong>逻辑</strong>: 会自动判断 <code>source</code> 是否在自适应面板中，如果在，则使用 <code>clientWidth</code> 而非 <code>rect.width</code> 以避免缩放导致的尺寸偏差。</li></ul><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> rect</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> syncContSize</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  source: buttonEl,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  target: tooltipEl,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  syncPosition: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  positionBaseTo: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;root&#39;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// rect: { width: 100, height: 40, left: 200, top: 300 }</span></span></code></pre></div><h2 id="模板解析" tabindex="-1">模板解析 <a class="header-anchor" href="#模板解析" aria-label="Permalink to &quot;模板解析&quot;">​</a></h2><h3 id="tcoretpl-string" tabindex="-1">tCoreTpl(string) <a class="header-anchor" href="#tcoretpl-string" aria-label="Permalink to &quot;tCoreTpl(string)&quot;">​</a></h3><p>一个极简的字符串模板解析函数。用于解析 <code>[key]value</code> 格式的特定配置字符串。（目前用于解析Wasm模块中的部分模板字符串）</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> configStr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;[title]Hello TechUI[color]Blue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> config</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> tCoreTpl</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(configStr);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(config);</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 输出: { title: &quot;Hello TechUI&quot;, color: &quot;Blue&quot; }</span></span></code></pre></div>`,37)])])}const g=i(n,[["render",l]]);export{c as __pageData,g as default};
