import{_ as r,C as t,o as k,c as d,j as s,a,E as l,ah as n,w as o}from"./chunks/framework.PKn7PQPU.js";const C=JSON.parse('{"title":"转场动画","description":"","frontmatter":{},"headers":[],"relativePath":"cn/_common/support/viewtrans.md","filePath":"cn/_common/support/viewtrans.md"}'),g={name:"cn/_common/support/viewtrans.md"},E={tabindex:"0"},c={style:{"text-align":"left"}};function y(u,i,F,v,b,m){const e=t("AbsTag"),p=t("Primary"),h=t("LinkItem");return k(),d("div",null,[i[13]||(i[13]=s("h1",{id:"转场动画",tabindex:"-1"},[a("转场动画 "),s("a",{class:"header-anchor",href:"#转场动画","aria-label":'Permalink to "转场动画"'},"​")],-1)),l(e,{types:"star"}),i[14]||(i[14]=n(`<p>TechUI 基于现代浏览器原生的 View Transitions API，封装了一套高性能的视图转场系统。它可以在路由跳转、主题切换或任意 DOM 更新时，自动捕获界面快照并执行影院级的过渡动画。</p><p>它是一个全局的过渡动效工具，可以实现以下功能</p><ul><li>路由切换过渡动效 <ul><li>可以实现有序切换（配合路由Order参数，实现类似，左侧翻转，右侧翻转等效果）</li><li>可以实现无序切换</li></ul></li><li>主题切换过渡动效</li><li>局部切换动效（如特定Dom容器）</li></ul><h2 id="兼容性说明" tabindex="-1">兼容性说明 <a class="header-anchor" href="#兼容性说明" aria-label="Permalink to &quot;兼容性说明&quot;">​</a></h2><p>由于使用了 <code>document.startViewTransition</code> API，该功能仅支持 <strong>Chromium 内核</strong> 浏览器（如 Chrome 111+、Edge 111+）。</p><p>在不支持的浏览器（如 Firefox、Safari）中，系统会自动降级处理：直接执行状态更新或路由跳转，不播放过渡动画，不会影响业务逻辑的正常运行。</p><h2 id="核心用法" tabindex="-1">核心用法 <a class="header-anchor" href="#核心用法" aria-label="Permalink to &quot;核心用法&quot;">​</a></h2><p>在组件中，您可以通过注入 <code>$global</code> 来获取转场相关的核心方法。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { inject } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;vue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  routerTransition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 路由跳转转场</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  themeToggle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,      </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 主题切换转场</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  viewTransToggle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 手动配置转场参数</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  viewTransStart</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 手动触发转场</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;$global&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="路由跳转-routertransition" tabindex="-1">路由跳转 (routerTransition) <a class="header-anchor" href="#路由跳转-routertransition" aria-label="Permalink to &quot;路由跳转 (routerTransition)&quot;">​</a></h3><p>这是最常用的方法，用于替代 Vue Router 的 <code>router.push</code>，让页面跳转具备动画效果。</p><p><strong>基础用法</strong>：</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 跳转到仪表盘，使用默认动画</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">routerTransition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ path: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/dashboard&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> });</span></span></code></pre></div><p><strong>指定动画效果</strong>：</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">routerTransition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  path: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/login&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  transName: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;vt-ripple&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 指定涟漪效果</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  transDur: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.5</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">           // 动画时长 1.5s</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p><strong>基于顺序自动判断方向</strong>： 如果在路由配置 (<code>meta.order</code>) 中定义了顺序索引，开启 <code>useOrder</code> 后，系统会自动判断是“前进”还是“后退”动画。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 如果当前 order: 1，目标 order: 2，则播放前进动画 (vt-slide-left)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 如果当前 order: 2，目标 order: 1，则播放后退动画 (vt-slide-right)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">routerTransition</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  path: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;/detail&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  useOrder: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span></code></pre></div><p><strong>API 参数表</strong>：</p>`,18)),s("table",E,[i[12]||(i[12]=s("thead",null,[s("tr",null,[s("th",{style:{"text-align":"left"}},"参数名"),s("th",{style:{"text-align":"left"}},"类型"),s("th",{style:{"text-align":"left"}},"默认值"),s("th",{style:{"text-align":"left"}},"说明")])],-1)),s("tbody",null,[i[7]||(i[7]=s("tr",null,[s("td",{style:{"text-align":"left"}},[s("strong",null,"path")]),s("td",{style:{"text-align":"left"}},"String"),s("td",{style:{"text-align":"left"}},"-"),s("td",{style:{"text-align":"left"}},"目标路由路径（必填）。")],-1)),s("tr",null,[s("td",c,[i[1]||(i[1]=s("strong",null,"query",-1)),i[2]||(i[2]=a()),i[3]||(i[3]=s("br",null,null,-1)),l(p,{size:"s"},{default:o(()=>[...i[0]||(i[0]=[a("V0.0.5+",-1)])]),_:1})]),i[4]||(i[4]=s("td",{style:{"text-align":"left"}},"Object",-1)),i[5]||(i[5]=s("td",{style:{"text-align":"left"}},"-",-1)),i[6]||(i[6]=s("td",{style:{"text-align":"left"}},"路由查询参数。",-1))]),i[8]||(i[8]=s("tr",null,[s("td",{style:{"text-align":"left"}},[s("strong",null,"transName")]),s("td",{style:{"text-align":"left"}},"String"),s("td",{style:{"text-align":"left"}},[s("code",null,"null")]),s("td",{style:{"text-align":"left"}},"指定动画名称（见下文列表）。若为空则使用默认配置。")],-1)),i[9]||(i[9]=s("tr",null,[s("td",{style:{"text-align":"left"}},[s("strong",null,"transTarget")]),s("td",{style:{"text-align":"left"}},"String"),s("td",{style:{"text-align":"left"}},[s("code",null,"null")]),s("td",{style:{"text-align":"left"}},[a("动画作用目标（如 "),s("code",null,"'root'"),a(", "),s("code",null,"'layout'"),a("）。")])],-1)),i[10]||(i[10]=s("tr",null,[s("td",{style:{"text-align":"left"}},[s("strong",null,"transDur")]),s("td",{style:{"text-align":"left"}},"Number"),s("td",{style:{"text-align":"left"}},[s("code",null,"null")]),s("td",{style:{"text-align":"left"}},"动画持续时间（秒）。")],-1)),i[11]||(i[11]=s("tr",null,[s("td",{style:{"text-align":"left"}},[s("strong",null,"useOrder")]),s("td",{style:{"text-align":"left"}},"Boolean"),s("td",{style:{"text-align":"left"}},[s("code",null,"false")]),s("td",{style:{"text-align":"left"}},[a("是否根据 "),s("code",null,"meta.order"),a(" 自动判断动画方向。")])],-1))])]),i[15]||(i[15]=n(`<h3 id="主题切换-themetoggle" tabindex="-1">主题切换 (themeToggle) <a class="header-anchor" href="#主题切换-themetoggle" aria-label="Permalink to &quot;主题切换 (themeToggle)&quot;">​</a></h3><p>TechUI 内置了主题切换的转场封装。当您调用此方法时，系统会以当前点击位置或中心点为圆心，播放圆形扩散（或配置的其他）动画。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 切换到深蓝主题</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">themeToggle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;darkBlue&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;dark&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span></code></pre></div><h3 id="自定义转场" tabindex="-1">自定义转场 <a class="header-anchor" href="#自定义转场" aria-label="Permalink to &quot;自定义转场&quot;">​</a></h3><p>如果您需要在非路由、非主题切换的场景下（例如手动更新某个 DOM 节点内容）使用转场动画，可以组合使用 <code>viewTransToggle</code> 和 <code>viewTransStart</code>。</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> handleUpdate</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> async</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 1. 配置动画参数：作用于 root 节点，使用溶解效果，时长 0.5s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  viewTransToggle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;root&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;vt-dissolve&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0.5</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 2. 等待 DOM 更新准备就绪</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> nextTick</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">();</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 3. 开始转场</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  viewTransStart</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    callback</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 在回调中执行实际的 DOM 更新操作</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">      showDetail.value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    },</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    enable: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 强制开启</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">    complete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      // 动画完成后的回调，通常用于重置参数</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      viewTransToggle</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); </span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  });</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">};</span></span></code></pre></div><h2 id="全局配置" tabindex="-1">全局配置 <a class="header-anchor" href="#全局配置" aria-label="Permalink to &quot;全局配置&quot;">​</a></h2><p>您可以在 <code>$globalConfig</code> 中控制转场功能的全局开关。</p><ul><li><strong><code>transition</code></strong>: <code>Boolean</code><ul><li><code>true</code>: 启用转场动画（默认）。</li><li><code>false</code>: 全局禁用，所有 <code>routerTransition</code> 将直接跳转无动画。</li></ul></li></ul><h2 id="动画效果列表" tabindex="-1">动画效果列表 <a class="header-anchor" href="#动画效果列表" aria-label="Permalink to &quot;动画效果列表&quot;">​</a></h2><p>TechUI 预设了丰富的动画效果，您可以在 <code>transName</code> 参数中直接使用这些名称。</p><h3 id="几何-遮罩类" tabindex="-1">几何/遮罩类 <a class="header-anchor" href="#几何-遮罩类" aria-label="Permalink to &quot;几何/遮罩类&quot;">​</a></h3><p>适合大幅度的场景切换或主题切换。</p><ul><li><strong><code>vt-overlap</code></strong>: 重叠缩放（默认通用效果）。</li><li><strong><code>vt-circle</code></strong>: 圆形扩散（中心）。</li><li><strong><code>vt-circle-rt</code></strong>: 圆形扩散（右上角）。</li><li><strong><code>vt-circle-tc</code></strong>: 圆形扩散（顶部中心）。</li><li><strong><code>vt-ripple</code></strong>: 涟漪扩散。</li></ul><h3 id="渐变-溶解类" tabindex="-1">渐变/溶解类 <a class="header-anchor" href="#渐变-溶解类" aria-label="Permalink to &quot;渐变/溶解类&quot;">​</a></h3><p>适合内容更新或温和的页面切换。</p><ul><li><strong><code>vt-fade</code></strong>: 标准淡入淡出。</li><li><strong><code>vt-dissolve</code></strong>: 溶解过渡。</li></ul><h3 id="滑动类-slide" tabindex="-1">滑动类 (Slide) <a class="header-anchor" href="#滑动类-slide" aria-label="Permalink to &quot;滑动类 (Slide)&quot;">​</a></h3><p>适合具有空间层级关系的页面切换。</p><ul><li><strong><code>vt-slide-up</code></strong>: 向上滑入。</li><li><strong><code>vt-slide-down</code></strong>: 向下滑入。</li><li><strong><code>vt-slide-left</code></strong>: 向左滑入（通常用于“前进”）。</li><li><strong><code>vt-slide-right</code></strong>: 向右滑入（通常用于“后退”）。</li></ul><h3 id="翻转类-flip" tabindex="-1">翻转类 (Flip) <a class="header-anchor" href="#翻转类-flip" aria-label="Permalink to &quot;翻转类 (Flip)&quot;">​</a></h3><p>适合卡片翻转或特殊的展示效果。</p><ul><li><strong><code>vt-flip-up</code></strong>: 向上翻转。</li><li><strong><code>vt-flip-down</code></strong>: 向下翻转。</li><li><strong><code>vt-flip-left</code></strong>: 向左翻转。</li><li><strong><code>vt-flip-right</code></strong>: 向右翻转。</li></ul><h2 id="致谢与出处" tabindex="-1">致谢与出处 <a class="header-anchor" href="#致谢与出处" aria-label="Permalink to &quot;致谢与出处&quot;">​</a></h2>`,24)),l(h,{icon:"qdly",ext:"jpg",label:"前端老鹰",detail:"BiliBili",link:"https://space.bilibili.com/397874328"}),i[16]||(i[16]=s("p",null,[a("关于全局转场效果的构想最早萌芽于一些技术博客，但因故搁置。直到偶然看到 "),s("code",null,"前端老鹰"),a(" 的分享，才真正促使我将其落地，并首先应用于 TechUI 的主题切换功能。")],-1)),i[17]||(i[17]=s("p",null,"随着开发的深入，我发现这一效果不应局限于“换肤”。通过进一步的抽象与封装，我将其升级为一个功能强大的通用组件。现在，它不仅能处理复杂的主题切换，还能通过丰富的配置项，完美支持区分方向的路由跳转、Vue 组件切换以及各类局部动效需求。",-1)),i[18]||(i[18]=s("p",null,[a("请点击这里查看原视频讲解 "),s("a",{href:"https://www.bilibili.com/video/BV1YVHazJEwa",target:"_blank",rel:"noreferrer"},"前端老鹰-主题切换动画效果")],-1))])}const x=r(g,[["render",y]]);export{C as __pageData,x as default};
