import r from"./cn__common_blocks_thanks_echarts.md.DpoR7Z6I.js";import{C as a,c,o as n,j as d,G as e,aj as i,a as s,k as l}from"./chunks/framework.DPdjieCD.js";const m=JSON.parse('{"title":"TuiEchartsMap","description":"","frontmatter":{},"headers":[],"relativePath":"cn/_common/advanced/echartsMap.md","filePath":"cn/_common/advanced/echartsMap.md"}'),h={name:"cn/_common/advanced/echartsMap.md"},q=Object.assign(h,{setup(g){return(p,t)=>{const o=a("AbsTag");return n(),c("div",null,[t[0]||(t[0]=d("h1",{id:"tuiechartsmap",tabindex:"-1"},[s("TuiEchartsMap "),d("a",{class:"header-anchor",href:"#tuiechartsmap","aria-label":'Permalink to "TuiEchartsMap"'},"​")],-1)),e(o,{types:"adv enh star",ver:"0.0.3"}),t[1]||(t[1]=i('<p><code>TuiEchartsMap</code> 是 TechUI 图表体系中的<strong>地理空间业务壳层 (Geospatial Business Shell)</strong>。</p><p>它不仅是一个用于承载地图的容器，更是一个<strong>智能的逻辑编排宿主</strong>。它采用了<strong>分离式架构设计</strong>，将 ECharts 原生的 GIS 渲染能力包裹在内部，并通过外层壳体接管了复杂的<strong>地图下钻路径管理</strong>、<strong>多维视图切换</strong>以及<strong>时间轴数据轮播</strong>等交互逻辑。</p><p>开发者无需关心底层的 GeoJSON 加载与坐标系重绘，只需通过这层“外壳”提供的标准接口（Pipeline），即可快速构建出具备企业级深度定制能力的地理可视化应用。</p><blockquote><p><strong>注意</strong>：本组件专注于 2D 矢量地图的高性能渲染（基于 SVG）。如需使用 3D 模式，请务必阅读文末的 <a href="#限制与说明">3D 地图支持说明</a>。</p></blockquote><h2 id="核心架构-管道化处理" tabindex="-1">核心架构 管道化处理 <a class="header-anchor" href="#核心架构-管道化处理" aria-label="Permalink to &quot;核心架构 管道化处理&quot;">​</a></h2><p>为了应对复杂的地图业务逻辑（如异步数据加载、下钻路径管理、动态样式计算），本组件采用了 <strong>MVC 分离式架构</strong>。<code>index.vue</code> 仅作为控制器（Controller），具体的业务逻辑通过 &quot;Utils Pipeline&quot; 进行流式处理。</p><h3 id="推荐目录结构" tabindex="-1">推荐目录结构 <a class="header-anchor" href="#推荐目录结构" aria-label="Permalink to &quot;推荐目录结构&quot;">​</a></h3><p>建议将地图逻辑拆分为以下独立模块：</p><ul><li><strong>Controller (<code>index.vue</code>)</strong>: 负责状态管理 (<code>reactive</code>), 事件监听 (<code>chartClick</code>), 组件挂载。</li><li><strong>Pipeline Utils</strong>:</li><li><code>0.themeExtra.js</code>: 主题与样式映射配置。</li><li><code>1.getMapData.js</code>: 负责 GeoJSON 数据的异步获取与缓存策略。</li><li><code>2.processOption.js</code>: 处理 ECharts <code>geo</code> 与 <code>visualMap</code> 等基础配置。</li><li><code>3.processData.js</code>: 处理 <code>series</code> 数据（散点、Pin 图标、热力值）的生成与清洗。</li><li><code>init.js</code>: 组装上述模块的统一入口。</li></ul><p>这种架构使得地图实例极易维护和扩展，实现了视图层与逻辑层的解耦。</p><div class="warning custom-block"><p class="custom-block-title">远程示例说明</p><p>由于地图组件采用了管道化分离架构，涉及复杂的异步数据流与交互逻辑，不便在文档中单页展示。请前往 GitHub 或 Gitee 仓库的 Prime 测试用例 目录中查看完整的工程化源码。</p></div><h2 id="核心功能特性" tabindex="-1">核心功能特性 <a class="header-anchor" href="#核心功能特性" aria-label="Permalink to &quot;核心功能特性&quot;">​</a></h2><h3 id="数据切换-data-switching" tabindex="-1">数据切换 (Data Switching) <a class="header-anchor" href="#数据切换-data-switching" aria-label="Permalink to &quot;数据切换 (Data Switching)&quot;">​</a></h3><p>组件支持在同一地图底图上动态切换不同的数据维度。</p><ul><li><strong>多形态标记</strong>：支持根据数据类型切换标记形态，例如从 <strong>散点 (Scatter)</strong> 切换到 <strong>带数值的 Pin 图标</strong>。</li><li><strong>样式差异化</strong>：不同数据组可以配置完全不同的颜色方案、图标大小逻辑以及热力区域样式。</li><li><strong>动态渲染</strong>：结合 <code>updateReplace</code> 机制，切换数据时无需销毁实例，可平滑过渡。</li></ul><h3 id="图层切换-layer-switching" tabindex="-1">图层切换 (Layer Switching) <a class="header-anchor" href="#图层切换-layer-switching" aria-label="Permalink to &quot;图层切换 (Layer Switching)&quot;">​</a></h3><p>支持复杂的图层控制逻辑，满足多维度的可视化需求。</p><ul><li><strong>图元显隐</strong>：可以自由控制特定图层（如标点、特效散点、标签）的显示与隐藏。</li><li><strong>GeoJSON 覆盖</strong>：支持自定义 GeoJSON 图层叠加，用于显示特殊的地理边界或自定义区域。</li><li><strong>模式切换</strong>：支持从“行政区划填充模式”（Choropleth）无缝切换至“地理描点模式”（Scatter/EffectScatter）。</li></ul><h3 id="时间轴-timeline" tabindex="-1">时间轴 (Timeline) <a class="header-anchor" href="#时间轴-timeline" aria-label="Permalink to &quot;时间轴 (Timeline)&quot;">​</a></h3><p>集成时间维度的数据展示能力。</p><ul><li><strong>多维度演变</strong>：结合 ECharts Timeline 组件，展示数据随年份或时间段的变化趋势。</li><li><strong>自动轮播</strong>：支持配置时间轴的自动播放，实现数据的动态演播效果。</li><li><strong>图表联动</strong>：时间轴的变化可以同时驱动地图数据与关联图表（如右侧排行榜）的同步更新。</li></ul><h3 id="主题同步-theming" tabindex="-1">主题同步 (Theming) <a class="header-anchor" href="#主题同步-theming" aria-label="Permalink to &quot;主题同步 (Theming)&quot;">​</a></h3><p>深度集成 TechUI 全局主题系统。</p><ul><li><strong>全局响应</strong>：组件会自动监听 <code>$gTheme</code> 的变化，实时刷新地图配色。</li><li><strong>精细化定制 (<code>themeExtra</code>)</strong>：通过 <code>0.themeExtra.js</code> 配置文件，您可以针对不同主题（DeepBlue, Light, Dark）单独定义地图区域颜色、边框色、高亮色以及 Pin 图标的渐变色。</li></ul><h3 id="地图下钻-drill-down" tabindex="-1">地图下钻 (Drill-down) <a class="header-anchor" href="#地图下钻-drill-down" aria-label="Permalink to &quot;地图下钻 (Drill-down)&quot;">​</a></h3><p>内置开箱即用的层级交互能力。</p><ul><li><strong>交互式下钻</strong>：点击地图区域，自动加载下级行政区划数据并重绘地图。</li><li><strong>面包屑导航 (<code>breadcrumb</code>)</strong>：顶部自动显示当前导航路径（如：全国 &gt; 浙江省 &gt; 杭州市），支持点击面包屑返回上级。</li><li><strong>层级感知</strong>：组件内部维护 <code>navBcrumb</code> 状态队列，自动管理当前层级深度。</li></ul><h3 id="数据联动-data-linkage" tabindex="-1">数据联动 (Data Linkage) <a class="header-anchor" href="#数据联动-data-linkage" aria-label="Permalink to &quot;数据联动 (Data Linkage)&quot;">​</a></h3><p>地图组件不仅仅是一个独立的视图，它通常作为整个大屏的**“上下文控制器 (Context Controller)”**。</p><ul><li><strong>状态监测</strong>：通过监听 <code>navBcrumb</code> 对象，父组件可以实时感知当前地图的导航深度与区域信息。</li><li><strong>周边协同</strong>：当用户下钻至某一省份（如“浙江省”）时，您可以通过 <code>watch</code> 捕获最新的 <code>adcode</code>，并即时触发周边组件（如右侧排行榜、顶部统计卡片）的数据刷新，实现**“地图动，全屏动”**的联动体验。</li></ul><h3 id="详情气泡-popup-info" tabindex="-1">详情气泡 (Popup Info) <a class="header-anchor" href="#详情气泡-popup-info" aria-label="Permalink to &quot;详情气泡 (Popup Info)&quot;">​</a></h3><p>支持丰富的信息展示交互。</p><ul><li><strong>触发方式</strong>：支持 <code>click</code> 手动触发或 <code>interval</code> 自动轮询弹出。</li><li><strong>自定义内容</strong>：气泡内容完全由 Vue 组件渲染，支持复杂的 HTML 结构与业务逻辑。</li><li><strong>⚠️ 组件说明</strong>：示例代码中仅通过 <code>createPopover</code> 演示了基本的 DOM 挂载逻辑，实际使用时请结合您项目中的基础 UI 组件库实现气泡样式。(如：TechUI Scifi 组件库不包含 <code>PopInfo</code> 或 <code>PopTip</code> 组件需自行开发相关的组件)</li></ul><h2 id="限制与说明" tabindex="-1">限制与说明 <a class="header-anchor" href="#限制与说明" aria-label="Permalink to &quot;限制与说明&quot;">​</a></h2><h3 id="地图实例开放权限" tabindex="-1">地图实例开放权限 <a class="header-anchor" href="#地图实例开放权限" aria-label="Permalink to &quot;地图实例开放权限&quot;">​</a></h3><ul><li><strong>测试用例</strong>：在Github和Gitee中，仅Prime组件库提供基础的地图展示实例，<strong>不包含</strong>完整的地图下钻逻辑与复杂交互源码。</li><li><strong>授权版</strong>：完整的地图下钻、管道化架构及多视图切换的高级实例，属于企业级授权内容，需取得授权后方可查看与使用。</li></ul><h3 id="geojson-数据来源" tabindex="-1">GeoJSON 数据来源 <a class="header-anchor" href="#geojson-数据来源" aria-label="Permalink to &quot;GeoJSON 数据来源&quot;">​</a></h3><ul><li><strong>不提供数据</strong>：考虑到地图数据的时效性与测绘合规性，本组件库 <strong>不内置也不提供</strong> 任何 GeoJSON 文件。</li><li><strong>获取方式</strong>：请开发者自行前往阿里云 DataV、高德开放平台或其他合规的开源数据平台下载所需的 GeoJSON 数据，并通过 <code>1.getMapData.js</code> 进行加载配置。</li></ul><h3 id="_3d-地图支持说明-风险提示" tabindex="-1">3D 地图支持说明 (风险提示) <a class="header-anchor" href="#_3d-地图支持说明-风险提示" aria-label="Permalink to &quot;3D 地图支持说明 (风险提示)&quot;">​</a></h3><p>虽然 <code>TuiEchartsMap</code> 理论上支持通过配置 <code>echarts-gl</code> 实现 3D 地球或 3D 地图效果，但我们 <strong>强烈建议谨慎使用</strong>，理由如下：</p><ul><li><strong>维护停滞</strong>：<code>echarts-gl</code> 组件库更新缓慢，且与 ECharts 5/6 版本的兼容性存在诸多已知问题。</li><li><strong>交互缺失</strong>：在 3D 模式下，许多基础交互（如区域点击下钻、Tooltip 精确触发）可能无法正常工作或响应迟钝。</li><li><strong>版本回退</strong>：若必须使用 3D 模式，通常需要将 ECharts 核心库回退至 v5.x 版本，这可能会影响项目中其他图表的特性使用。</li></ul><h2 id="api-参考" tabindex="-1">API 参考 <a class="header-anchor" href="#api-参考" aria-label="Permalink to &quot;API 参考&quot;">​</a></h2><h3 id="props-属性" tabindex="-1">Props (属性) <a class="header-anchor" href="#props-属性" aria-label="Permalink to &quot;Props (属性)&quot;">​</a></h3><p>除了地图特有的配置外，组件还完整透传了容器尺寸与渲染控制属性。</p><table tabindex="0"><thead><tr><th>属性名</th><th>类型</th><th>默认值</th><th>说明</th></tr></thead><tbody><tr><td><strong>chartOption</strong></td><td><code>Object</code></td><td>(Required)</td><td>图表核心配置对象。</td></tr><tr><td><strong>geoJsonData</strong></td><td><code>Object</code></td><td>(Required)</td><td>当前地图的 GeoJSON 数据对象。</td></tr><tr><td><strong>mapName</strong></td><td><code>String</code></td><td>(Required)</td><td>当前地图注册名称（如 &#39;china&#39;）。</td></tr><tr><td><strong>allAreaCodes</strong></td><td><code>Array</code></td><td>-</td><td>行政区划映射表，用于下钻时的名称-代码转换。</td></tr><tr><td><strong>width</strong></td><td><code>Number/String</code></td><td>-</td><td>容器宽度。</td></tr><tr><td><strong>height</strong></td><td><code>Number/String</code></td><td>-</td><td>容器高度。</td></tr><tr><td><strong>renderer</strong></td><td><code>String</code></td><td><code>&#39;canvas&#39;</code></td><td>渲染模式。推荐使用 <code>&#39;svg&#39;</code> 以获得最佳清晰度。</td></tr><tr><td><strong>updateReplace</strong></td><td><code>Boolean</code></td><td><code>true</code></td><td>更新数据时是否使用 <code>replaceMerge</code> 策略，用于平滑切换图层。</td></tr><tr><td><strong>enableBreadcrumb</strong></td><td><code>Boolean</code></td><td><code>false</code></td><td>是否启用内置的面包屑导航与下钻逻辑。</td></tr><tr><td><strong>breadcrumbConfig</strong></td><td><code>Object</code></td><td><code>{ data: [...], position: ... }</code></td><td>面包屑配置项（初始路径、位置坐标）。</td></tr><tr><td><strong>loading</strong></td><td><code>Boolean</code></td><td><code>null</code></td><td>加载状态控制 (支持 <code>v-model:loading</code>)。</td></tr><tr><td><strong>ready</strong><br><code>v0.0.5+</code></td><td><code>Boolean</code></td><td><code>false</code></td><td><strong>渲染控制信号</strong>。设为 <code>true</code> 时才开始初始化/渲染。</td></tr><tr><td><strong>initOptions</strong></td><td><code>Object</code></td><td><code>{}</code></td><td>ECharts 初始化附加参数 (如 <code>devicePixelRatio</code>, <code>locale</code>)。</td></tr><tr><td><strong>resizeObserver</strong></td><td><code>String</code></td><td><code>&#39;global&#39;</code></td><td>自适应策略。<code>&#39;self&#39;</code>(自身), <code>&#39;global&#39;</code>(窗口), <code>&#39;none&#39;</code>(禁用)。</td></tr><tr><td><strong>dataOpacity</strong></td><td><code>Number</code></td><td>-</td><td>数据层透明度（透传给底层渲染器）。</td></tr><tr><td><strong>dataBlur</strong></td><td><code>Number</code></td><td>-</td><td>数据层模糊度（透传给底层渲染器）。</td></tr></tbody></table><div class="tip custom-block"><p class="custom-block-title">移除的props</p><ul><li>在<code>v0.0.5</code>移除过时的Props: initDelay 、initHold;</li></ul></div><h3 id="events-事件" tabindex="-1">Events (事件) <a class="header-anchor" href="#events-事件" aria-label="Permalink to &quot;Events (事件)&quot;">​</a></h3><p>组件转发了所有 ECharts 标准交互事件及地图特有逻辑事件。</p><table tabindex="0"><thead><tr><th>事件类别</th><th>事件名</th><th>说明</th></tr></thead><tbody><tr><td><strong>交互事件</strong></td><td><code>chartClick</code></td><td>单击地图区域或标记（常用于下钻）。</td></tr><tr><td></td><td><code>chartDblClick</code></td><td>双击事件。</td></tr><tr><td></td><td><code>chartMouseDown</code></td><td>鼠标按下。</td></tr><tr><td></td><td><code>chartMouseUp</code></td><td>鼠标抬起。</td></tr><tr><td></td><td><code>chartMouseOver</code></td><td>鼠标悬停（常用于高亮提示）。</td></tr><tr><td></td><td><code>chartGlobalOut</code></td><td>鼠标移出图表容器范围。</td></tr><tr><td></td><td><code>chartGeoRoam</code></td><td>地图漫游事件（缩放/平移），常用于同步更新气泡位置。</td></tr><tr><td><strong>生命周期</strong></td><td><code>chartInit</code></td><td>实例初始化完成。</td></tr><tr><td></td><td><code>chartReady</code></td><td>图表首次渲染完成（包含动画）。</td></tr><tr><td></td><td><code>chartRendered</code></td><td>每次渲染动作发生时触发。</td></tr><tr><td></td><td><code>chartFinished</code></td><td>渲染动作完全停止时触发。</td></tr><tr><td><strong>业务事件</strong></td><td><code>chartUpdate</code></td><td>图表更新事件。</td></tr><tr><td></td><td><code>chartTimelinechanged</code></td><td>时间轴节点切换事件。</td></tr><tr><td></td><td><code>breadcrumbClick</code></td><td>点击面包屑导航时触发。</td></tr><tr><td></td><td><code>update:loading</code></td><td>加载状态双向绑定更新。</td></tr></tbody></table><h3 id="methods-方法" tabindex="-1">Methods (方法) <a class="header-anchor" href="#methods-方法" aria-label="Permalink to &quot;Methods (方法)&quot;">​</a></h3><p>可通过 <code>ref</code> 调用组件暴露的内部方法。</p><table tabindex="0"><thead><tr><th>方法名</th><th>参数</th><th>说明</th></tr></thead><tbody><tr><td><strong><code>initChart</code></strong></td><td>-</td><td>手动触发图表初始化流程。</td></tr><tr><td><strong><code>setOption</code></strong></td><td><code>(option, notMerge, lazyUpdate)</code></td><td>动态更新图表配置。</td></tr><tr><td><strong><code>getChart</code></strong></td><td>-</td><td>获取原始 ECharts 实例对象。</td></tr><tr><td><strong><code>resize</code></strong></td><td>-</td><td>强制触发图表尺寸重绘。</td></tr><tr><td><strong><code>resetMapView</code></strong></td><td>-</td><td><strong>特有方法</strong>：重置地图的缩放比例与中心点到初始状态。</td></tr><tr><td><strong><code>clear</code></strong></td><td>-</td><td>清空当前实例画布。</td></tr><tr><td><strong><code>dispose</code></strong></td><td>-</td><td>销毁实例，释放资源。</td></tr></tbody></table>',52)),e(l(r))])}}});export{m as __pageData,q as default};
