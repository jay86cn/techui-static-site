import{_ as i,c as a,o as e,aj as t}from"./chunks/framework.DPdjieCD.js";const c=JSON.parse('{"title":"Component Register","description":"","frontmatter":{},"headers":[],"relativePath":"en/_common/admin/comptRegister.md","filePath":"en/_common/admin/comptRegister.md"}'),n={name:"en/_common/admin/comptRegister.md"};function l(h,s,o,r,p,k){return e(),a("div",null,[...s[0]||(s[0]=[t(`<h1 id="component-register" tabindex="-1">Component Register <a class="header-anchor" href="#component-register" aria-label="Permalink to &quot;Component Register&quot;">​</a></h1><p>In the TechUI Workbench (Admin) system, the <strong>Component Register</strong> is the key bridge connecting &quot;backend menu data&quot; and &quot;frontend Vue component files&quot;.</p><p>Due to the strict static analysis limitations of build tools like Vite and Webpack on dynamic <code>import()</code> statements (which typically do not support fully dynamic variable paths), we need to maintain a <strong>registry</strong> on the frontend to explicitly declare the correspondence between &quot;route identifiers&quot; and &quot;file paths&quot;.</p><h2 id="core-mechanism" tabindex="-1">Core Mechanism <a class="header-anchor" href="#core-mechanism" aria-label="Permalink to &quot;Core Mechanism&quot;">​</a></h2><p>The component registry is essentially a key-value pair object:</p><ul><li><strong>Key:</strong> The unique identifier string for the route (e.g., <code>dashboard</code>). The <code>label</code> field in the menu data returned by the backend must match this Key exactly.</li><li><strong>Value:</strong> A function that returns a Promise, pointing to the specific <code>.vue</code> file path.</li></ul><h2 id="configuration-guide" tabindex="-1">Configuration Guide <a class="header-anchor" href="#configuration-guide" aria-label="Permalink to &quot;Configuration Guide&quot;">​</a></h2><h3 id="create-component" tabindex="-1">Create Component <a class="header-anchor" href="#create-component" aria-label="Permalink to &quot;Create Component&quot;">​</a></h3><p>First, develop standard Vue components in your <code>src/views</code> or <code>src/pages</code> directory.</p><h3 id="write-registry-register-js" tabindex="-1">Write Registry (register.js) <a class="header-anchor" href="#write-registry-register-js" aria-label="Permalink to &quot;Write Registry (register.js)&quot;">​</a></h3><p>Maintain the registry file in an appropriate location in your project (e.g., <code>src/navigation/register.js</code>).</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { markRaw } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Define component mapping relationship</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> register</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Key name: Must match the label field of the backend menu</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Value: Dynamic import function for the component</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Example: Dashboard</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  dashboard</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@/views/dashboard/index.vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Example: User Management</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  userList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@/views/system/user/list.vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // Example: System Settings</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">  setting</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: () </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;@/views/system/setting.vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">),</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Performance Optimization: Use markRaw</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Prevent these component loading functions from being proxied by Vue&#39;s reactivity system</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// to reduce unnecessary performance overhead.</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Object.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">keys</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(register).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">forEach</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">key</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  register[key] </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> markRaw</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(register[key]);</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">export</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> register;</span></span></code></pre></div><h3 id="global-injection" tabindex="-1">Global Injection <a class="header-anchor" href="#global-injection" aria-label="Permalink to &quot;Global Injection&quot;">​</a></h3><p>In the application entry file (such as <code>App.vue</code> or <code>main.js</code>), inject this registry into TechUI&#39;s global Admin state. This step must be completed before route initialization.</p><div class="language-javascript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// App.vue or main.js</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> componentRegister </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;./navigation/register&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">; </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Import the file above</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { inject } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;vue&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Get global service</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">$ADMIN</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> inject</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;$global&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">);</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Inject registry</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$ADMIN.value.componentRegister </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> componentRegister;</span></span></code></pre></div><h2 id="workflow" tabindex="-1">Workflow <a class="header-anchor" href="#workflow" aria-label="Permalink to &quot;Workflow&quot;">​</a></h2><p>Once the configuration is complete, when the dynamic routing system starts, it works according to the following process:</p><ol><li><strong>Fetch Data:</strong> The frontend retrieves the menu list from the backend API, for example:</li></ol><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;label&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;dashboard&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;title&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Dashboard&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#B31D28;--shiki-light-font-style:italic;--shiki-dark:#FDAEB7;--shiki-dark-font-style:italic;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span></code></pre></div><ol start="2"><li><strong>Lookup Component:</strong> The dynamic routing logic reads the <code>label</code> (&quot;dashboard&quot;) from the menu and looks up the corresponding Key in <code>$ADMIN.componentRegister</code>.</li><li><strong>Route Mounting:</strong> After finding the corresponding <code>() =&gt; import(...)</code> function, it uses it as the <code>component</code> argument to dynamically add it to the routing system via <code>router.addRoute</code>.</li></ol><h2 id="best-practices" tabindex="-1">Best Practices <a class="header-anchor" href="#best-practices" aria-label="Permalink to &quot;Best Practices&quot;">​</a></h2><ul><li><strong>Uniqueness:</strong> Ensure that the Keys in <code>register.js</code> are globally unique.</li><li><strong>On-demand Loading:</strong> Always use the arrow function form <code>() =&gt; import(...)</code> to ensure components are loaded only when accessed (code splitting), thereby optimizing initial load performance.</li><li><strong>Naming Conventions:</strong> It is recommended that Key naming remains semantically consistent with file paths or business functions to facilitate maintenance.</li></ul><h2 id="faq" tabindex="-1">FAQ <a class="header-anchor" href="#faq" aria-label="Permalink to &quot;FAQ&quot;">​</a></h2><p><strong>Q: Why can&#39;t I use the path returned by the backend directly?</strong><strong>A:</strong> Build tools (Vite/Webpack) need to know the exact file dependencies during packaging. If fully dynamic variables (like <code>import(serverPath)</code>) are used, the build tool cannot determine which files need to be packaged, resulting in the module not being found at runtime. Using <code>register.js</code> is equivalent to telling the build tool: &quot;These files might be used, please package them.&quot;</p><p><strong>Q: Why do I see a &quot;Component not found&quot; warning after adding a new page?</strong><strong>A:</strong> Please check the following two points:</p><ol><li>Whether the configuration for that page has been added to <code>register.js</code>.</li><li>Whether the <code>label</code> field in the menu data returned by the backend matches the Key in <code>register.js</code> exactly (case-sensitive).</li></ol>`,26)])])}const g=i(n,[["render",l]]);export{c as __pageData,g as default};
